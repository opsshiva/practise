{% extends "base.html" %}

{% block content %}
<style>

    body {
        background-color: #f5f5f5;
        font-family: Arial, sans-serif;
    }

    .csr-container {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
    }

    .csr-box {
        background-color: #fff;
        border-radius: 5px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        width: 600px; /* Increased width */
        padding: 40px;
    }


    .csr-title {
        font-size: 24px;
        margin-bottom: 20px;
        text-align: center;
    }

    table {
        width: 100%; /* Table width set to 100% */
        border-collapse: collapse;
    }

    th, td {
        border: 1px solid #ddd;
        padding: 12px; /* Increased padding */
        text-align: left;
    }

    th {
        background-color: #f2f2f2;
    }

    tr:nth-child(even) {
        background-color: #f9f9f9;
    }

    tr:hover {
        background-color: #f2f2f2;
    }

    .csr-button {
        width: 100%;
        padding: 12px;
        border: none;
        border-radius: 5px;
        background-color: #007bff;
        color: #fff;
        font-size: 18px;
        cursor: pointer;
    }

    .csr-button:hover {
        background-color: #0056b3;
    }
</style>

<div class="csr-container">
    <div class="csr-box">
        <h3 class="csr-title">CSR's that require approval</h3>
        <table border="1">
            <thead>
                <tr>
                    <th>CSR</th>
                    <th>NAME</th>
                    <th>ENV</th>
                    <th>APPROVE</th>
                </tr>
            </thead>
            {% set i = namespace(value=0) %}
            {% for a in acsrval %}
            <tr>
                {% set j = namespace(value=0) %}
                {% set k = namespace(value=0) %}
                {% set l = namespace(value=0) %}
                <td> {{a}} </td>
                {%for b in aname %}
                {% if i.value == j.value %}
                <td> {{b}} </td>
                {% endif %}
                {% set j.value = j.value + 1 %}
                {% endfor %}
                {%for d in aenv %}
                {% if i.value == l.value %}
                <td> {{d}} </td>
                {% endif %}
                {% set l.value = l.value + 1 %}
                {% endfor %}
                {%for c in aid %}
                {% if i.value == k.value %}
                <td><button class="approveButton" style="display: block;" value="{{ c }}">Approve</button></td>
                {% endif %}
                {% set k.value = k.value + 1 %}
                {% endfor %}
                {% set i.value = i.value + 1 %}
            </tr>
            {% endfor %}
        </table>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function(){
  $(".approveButton").click(function(){
    var value = $(this).val();
    var data = { apid: value };
    $.ajax({
      url: "/adminportal",
      type: "POST",
      data: JSON.stringify(data),
      contentType: "application/json; charset=utf-8",
      dataType: "json",
      success: function(response) {
        // Handle success response from backend
        console.log("Success:", response);
      },
      error: function(xhr, status, error) {
        // Handle error response from backend
        console.error("Error:", error);
      }
    });
  });
});
</script>
{% endblock %}
